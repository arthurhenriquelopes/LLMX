#!/bin/bash
set -e

# Executa apenas na configuraÃ§Ã£o
if [ "$1" = "configure" ]; then
    echo "ðŸ Configurando ambiente Python para LLMX..."
    
    cd "/opt/llmx"
    
    # Criar venv se nÃ£o existir
    if [ ! -d ".venv" ]; then
        python3 -m venv .venv
    fi
    
    # Instalar dependÃªncias
    source .venv/bin/activate
    
    echo "ðŸ“¦ Instalando dependÃªncias (pode demorar um pouco)..."
    pip install --no-cache-dir -r requirements.txt > /dev/null
    
    # Ajustar permissÃµes
    chmod -R 755 "/opt/llmx"
    
    echo "âœ… LLMX configurado com sucesso!"
    echo "â„¹ï¸  Para configurar sua API Key, edite o arquivo: /opt/llmx/.env"
    echo "   Ou execute 'llmx' e siga as instruÃ§Ãµes."

    # Atualizar menu
    if command -v update-desktop-database >/dev/null; then
        update-desktop-database
    fi
fi

exit 0
